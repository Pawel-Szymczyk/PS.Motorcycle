@page "/"
@using System.Security.Claims
@using Microsoft.AspNetCore.Components.Authorization
@using PS.Motorcycle.Domain.Types
@inject AuthenticationStateProvider AuthenticationStateProvider

<div class="main">
    
    <div class="main-section">

        <div class="breadcrumbs-container">
            <BreadcrumbComponent Breadcrumbs="@this.Breadcrumbs"></BreadcrumbComponent>
        </div>

    </div>


    <div id="search-section" class="main-section">
        <div class="panel search-panel">

            <div class="container">

                <div class="search-container">
                    <SearchComponent OnSearchClick="@this.OnSearchClick" />
                </div>


                @if(this.searchData is null)
                {
                    @*<p><em>Loading...</em></p>*@
                    <div>
                        <BodyTypeCaruselComponent OnBodyTypeClick="@this.OnBodyTypeFilterClick" />
                    </div>
                }
                else
                {
                    <div class="row">
                        <div class="col-sm-12 col-md-2 col-lg-2 " style="border-right: 1px solid rgba(0,0,0,.125);">
                            @*filters*@
                            <div class="filter-container">
                                <AzureCognitiveSearchMakeComponent MakeData="@this.makeData" 
                                                                    ModelData="@this.modelData" 
                                                                    OnMakeClick="@this.OnMakeClickHandlerAsync" 
                                                                    OnModelClick="@this.OnModelClickHandlerAsync" />

                                <AzureCognitiveSearchFacetComponent FacetsData="@this.facetsData" 
                                                                    OnFacetClick="@this.OnFacetClickHandlerAsync" />

                                <AzureCognitiveSearchProductionYearComponent YearData="@this.yearData" 
                                                                                OnMinYearChanged="@this.OnMinYearChangedHandlerAsync" 
                                                                                OnMaxYearChanged="@this.OnMaxYearChangedHandlerAsync" />

                                <AzureCognitiveSearchEngineCapacityComponent EngineCapacity="@this.engineCapacityData" 
                                                                                OnMinEngineCapacityChanged="@this.OnMinEngineCapacityChangedHandlerAsync"
                                                                                OnMaxEngineCapacityChanged="@this.OnMaxEngineCapacityChangedHandlerAsync" />
                            </div>
                        </div>

                        <div class="col-sm-2 col-md-10 col-lg-10 results-container">
                            @if(this.filters.Count() > 0)
                            {
                                <PillComponent Filters=@this.filters 
                                                OnFilterRemoveClick=@this.OnFilterRemoveClickHandlerAsync
                                                OnFilterResetClick=@this.OnFilterResetClickHandlerAsync />
                            }
                        
                            <div class="row row-cols-1 row-cols-md-3 g-4 motorcycles-list">
                                @*results *@

                                @{
                                    var results = this.searchData.resultList?.GetResults().ToList();
                                }

                                @foreach(var result in results)
                                {
                                    string path = $"/motorcycle/{result.Document.Id}";
                                    <CardComponent Motorcycle="result.Document" Path="@path" />
                                }
                            </div>
                        </div>
                    </div>
                }

            </div>
        </div>
    </div>
    <div class="main-section">
        @*pagination*@
        @if(this.searchData != null && this.searchData.pageCount > 1)
        {
            <div class="panel paging-panel container-fluid">
           
                <div class="row">
                    <div class="col-2"></div>
                    <div class="col-sm-12 col-md-10 pagination-container">
                        
                        <PagingComponent CurrentPage=@this.searchData.currentPage 
                                         LeftMostPage=@this.searchData.leftMostPage 
                                         PageCount=@this.searchData.pageCount 
                                         PageRange=@this.searchData.pageRange 
                                         SearchText=@this.searchData.searchText 
                                         OnSearchPagerClick=@this.OnSearchPagerClickHandlerAsync />

                    </div>
                </div>
           
            </div>
        }
    </div>
    <div class="main-section">
        <FooterComponent />
    </div>



</div>

