@page "/"
@using System.Security.Claims
@using Microsoft.AspNetCore.Components.Authorization
@using PS.Motorcycle.Domain.Types
@inject AuthenticationStateProvider AuthenticationStateProvider

<div style="height: inherit;">
    
    <div class="breadcrumbs-container">
        <BreadcrumbComponent Breadcrumbs="@this.Breadcrumbs"></BreadcrumbComponent>
    </div>

    <div class="container-fluid" style="background-color: white;  height: calc(100% - 10rem); padding-top: 50px; padding-bottom: 50px; border-radius: 10px; box-shadow: rgba(60, 64, 67, 0.3) 0px 1px 2px 0px, rgba(60, 64, 67, 0.15) 0px 2px 6px 2px; overflow-y: auto;">

        <div class="container">

            <div>
                <div class="search-container">
                    <SearchComponent OnSearchClick="@this.OnSearchClick" />
                </div>


                @if(this.searchData is null)
                {
                    @*<p><em>Loading...</em></p>*@
                    <div>
                        <BodyTypeCaruselComponent OnBodyTypeClick="@this.OnBodyTypeFilterClick" />
                    </div>
                }
                else
                {
                    <div class="row">
                        <div class="col-sm-12 col-md-2 col-lg-2" style="border-right: 1px solid rgba(0,0,0,.125);">
                            @*filters*@
                            <div class="filter-container">
                                <AzureCognitiveSearchMakeComponent MakeData="@this.makeData" 
                                                                   ModelData="@this.modelData" 
                                                                   OnMakeClick="@this.OnMakeClickHandlerAsync" 
                                                                   OnModelClick="@this.OnModelClickHandlerAsync" />
                                <AzureCognitiveSearchFacetComponent FacetsData="@this.facetsData" 
                                                                    OnFacetClick="@this.OnFacetClickHandlerAsync" />
                                <AzureCognitiveSearchProductionYearComponent YearData="@this.yearData" 
                                                                             OnMinYearChanged="@this.OnMinYearChangedHandlerAsync" 
                                                                             OnMaxYearChanged="@this.OnMaxYearChangedHandlerAsync" />
                                <AzureCognitiveSearchEngineCapacityComponent EngineCapacity="@this.engineCapacityData" 
                                                                             OnMinEngineCapacityChanged="@this.OnMinEngineCapacityChangedHandlerAsync"
                                                                             OnMaxEngineCapacityChanged="@this.OnMaxEngineCapacityChangedHandlerAsync" />
                            </div>
                        </div>

                        <div class="col-sm-2 col-md-10 col-lg-10 results-container">
                            @if(this.filters.Count() > 0)
                            {
                                <PillComponent Filters=@this.filters 
                                               OnFilterRemoveClick=@this.OnFilterRemoveClickHandlerAsync
                                               OnFilterResetClick=@this.OnFilterResetClickHandlerAsync />
                            }
                        

                            <div class="row row-cols-1 row-cols-md-3 g-4 motorcycles-list">
                                @*results *@

                                @{
                                    var results = this.searchData.resultList?.GetResults().ToList();
                                }

                                @foreach(var result in results)
                                {
                                    string path = $"/motorcycle/{result.Document.Id}";
                                    <CardComponent Motorcycle="result.Document" Path="@path" />
                                }
                            </div>
                        </div>
                    </div>
                }
            </div>

        </div>
    </div>



    @*pagination*@
    @if(this.searchData != null && this.searchData.pageCount > 1)
    {
        <div class="container-fluid" style="background-color: white; margin-top: 1em; border-radius: 10px; box-shadow: rgba(60, 64, 67, 0.3) 0px 1px 2px 0px, rgba(60, 64, 67, 0.15) 0px 2px 6px 2px;">
           
            <div class="row">
                <div class="col-2"></div>
                <div class="col-sm-12 col-md-10 pagination-container">
                        
                    <PagingComponent CurrentPage=@this.searchData.currentPage 
                                     LeftMostPage=@this.searchData.leftMostPage 
                                     PageCount=@this.searchData.pageCount 
                                     PageRange=@this.searchData.pageRange 
                                     SearchText=@this.searchData.searchText 
                                     OnSearchPagerClick=@this.OnSearchPagerClickHandlerAsync />

                </div>
            </div>
           
        </div>
    }
    


    <FooterComponent />
</div>

